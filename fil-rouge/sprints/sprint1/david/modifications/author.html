<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Ajouter un auteur | Admin citation</title>
    <link rel="stylesheet" href="public/css/bootstrap.min.css">
    <link rel="stylesheet" href="public/css/bootstrap-icons/bootstrap-icons.min.css">

</head>

<body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Citations admin</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link " href="quotes.html">Les citations</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="authors.html">Les auteurs</a>
                    </li>
                </ul>
                <ul class="navbar-nav me-0 mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="users.html">Les utilisateurs</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="profil.html">Mon profil</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html" target="_blank" title="le site"><i
                                class="bi bi-eye"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="exit.html" title="Se déconnecter"><i
                                class="bi bi-box-arrow-right"></i></a>
                    </li>
                </ul>

            </div>
        </div>
    </nav>
    <div class="container my-5">
        <h1 class="mb-5">Ajouter un auteur</h1>

        <form action="author_store.php" method="POST">
            <div class="mb-4">
                <label for="name" class="form-label">Nom de l'auteur (obligatoire)</label>
                <input type="text" class="form-control" id="name" name="name" required>
            </div>

            <div class="mb-4">
                <label for="birthdate" class="form-label">Date de naissance (facultatif)</label>
                <input type="date" class="form-control" id="birthdate" name="birthdate">
            </div>

            <div class="mb-4">
                <label for="deathdate" class="form-label">Date de décès (facultatif)</label>
                <input type="date" class="form-control" id="deathdate" name="deathdate">
            </div>

            <div class="mb-4">
                <label for="image" class="form-label">Image (obligatoire)</label>
                <input type="file" class="form-control" id="image" name="image" accept="image/*" required>
                <div class="mt-3">
                    <img id="preview" src="#" alt="Aperçu de l'image" style="max-height: 200px; display: none;" />
                </div>
            </div>

            <div class="mb-4">
                <label for="biography" class="form-label">Biographie (obligatoire)</label>
                <textarea class="form-control" id="biography" name="biography" rows="5" required></textarea>
            </div>

            <button type="submit" class="btn btn-success">
                <i class="bi bi-check-circle"></i> Enregistrer
            </button>
            <a href="authors.html" class="btn btn-secondary ms-3">
                <i class="bi bi-arrow-left"></i> Retour
            </a>
        </form>
    </div>

    <script src="public/js/bootstrap.bundle.min.js"></script>
    <script src="public/js/tinymce/tinymce.min.js"></script>
    <script>
        tinymce.init({
            selector: '#biography',
            language: 'fr_FR',
            language_url: 'public/js/tinymce/langs/fr_FR.js',
            height: 300,
            menubar: false,
            plugins: 'link image code lists',
            toolbar: 'undo redo | bold italic | alignleft aligncenter alignright | bullist numlist outdent indent | link image | code'
        });
    </script>
    <script>
        document.getElementById('image').addEventListener('change', function (event) {
            const input = event.target;
            const preview = document.getElementById('preview');

            if (input.files && input.files[0]) {
                const reader = new FileReader();

                reader.onload = function (e) {
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                }

                reader.readAsDataURL(input.files[0]);
            }
        });
        document.querySelector('form').addEventListener('submit', function (e) {
            const name = document.getElementById('name').value.trim();
            const image = document.getElementById('image').files.length;
            const biography = tinymce.get('biography').getContent({ format: 'text' }).trim(); // récupère le texte brut

            if (!name || !image || !biography) {
                e.preventDefault();

                let message = "Veuillez remplir tous les champs obligatoires :\n";
                if (!name) message += "- Nom de l'auteur\n";
                if (!image) message += "- Image\n";
                if (!biography) message += "- Biographie\n";

                alert(message);
            }
        });
        
    </script>
   <script>
document.querySelector('form').addEventListener('submit', function (e) {
    const name = document.getElementById('name').value.trim();
    const image = document.getElementById('image').files.length;
    const biography = tinymce.get('biography').getContent({ format: 'text' }).trim();
    const birthdate = document.getElementById('birthdate').value;
    const deathdate = document.getElementById('deathdate').value;

    let message = "";

    
    if (!name || !image || !biography) {
        message += "Veuillez remplir tous les champs obligatoires :\n";
        if (!name) message += "- Nom de l'auteur\n";
        if (!image) message += "- Image\n";
        if (!biography) message += "- Biographie\n";
    }

    
    if (birthdate && deathdate) {
        const birth = new Date(birthdate)
        const death = new Date(deathdate);

        if (birth > death) {
            message += "\nLa date de naissance doit être antérieure à la date de décès.";
        }
    }

    if (message) {
        e.preventDefault();
        alert(message);
    }
});
</script>

</body>

</html>